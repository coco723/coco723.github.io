(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{467:function(s,t,a){"use strict";a.r(t);var n=a(2),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("在 Qiankun 微前端框架中，JS 沙箱是一项关键的技术，用于隔离和保护子应用之间的 JavaScript 执行环境。JS 沙箱的主要目标是确保每个微前端子应用的 JavaScript 执行环境都是相互隔离的，避免全局变量污染和冲突。")]),s._v(" "),t("h3",{attrs:{id:"qiankun-中-js-沙箱的功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#qiankun-中-js-沙箱的功能"}},[s._v("#")]),s._v(" Qiankun 中 JS 沙箱的功能：")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("全局变量隔离：")]),s._v(" JS 沙箱通过隔离全局变量，确保每个子应用都有一个独立的全局作用域，防止全局变量的冲突。")]),s._v(" "),t("li",[t("strong",[s._v("沙箱上下文：")]),s._v(" 每个子应用都有一个独立的沙箱上下文，用于存储和管理子应用的运行时状态和数据。")]),s._v(" "),t("li",[t("strong",[s._v("执行脚本隔离：")]),s._v(" 子应用的 JavaScript 脚本在沙箱中执行，确保子应用之间的脚本不会相互影响。")]),s._v(" "),t("li",[t("strong",[s._v("事件隔离：")]),s._v(" 沙箱提供了自定义事件系统，确保每个子应用之间的事件通信是安全的，不会影响其他子应用。")])]),s._v(" "),t("h3",{attrs:{id:"配置和使用-js-沙箱"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置和使用-js-沙箱"}},[s._v("#")]),s._v(" 配置和使用 JS 沙箱：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("strictStyleIsolation（严格样式隔离）：")])])]),s._v(" "),t("p",[s._v("在 Qiankun 中，你可以通过配置 "),t("code",[s._v("sandbox")]),s._v(" 来启用和配置 JS 沙箱。以下是一个简单的配置示例：")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" registerMicroApps"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" start "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'qiankun'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("registerMicroApps")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'subapp1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("entry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:8081'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("container")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#subapp-container'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("activeRule")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/subapp1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("props")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 自定义配置 JS 沙箱")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("sandbox")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("strictStyleIsolation")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...其他子应用配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("p",[s._v("上述配置中的 "),t("code",[s._v("sandbox")]),s._v(" 属性用于自定义 JS 沙箱的行为。其中，"),t("code",[s._v("strictStyleIsolation")]),s._v(" 表示是否启用严格的样式隔离，它会将子应用的样式作用域限制在子应用自身，防止样式冲突")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("sandboxContainer（沙箱容器）：")])])]),s._v(" "),t("p",[t("code",[s._v("sandboxContainer")]),s._v(" 是一个配置项，用于指定子应用的容器元素。默认情况下，Qiankun 会自动创建一个容器元素，但你也可以通过该配置项手动指定容器元素的选择器。")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("sandbox")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("sandboxContainer")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#custom-container'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("disableSandbox（禁用沙箱）：")]),s._v(" "),t("code",[s._v("disableSandbox: true")]),s._v(" 表示禁用沙箱。在某些特殊情况下，你可能希望禁用沙箱来提高性能或解决一些不兼容的问题。请注意，禁用沙箱可能会导致一些安全性问题，谨慎使用。")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("sandbox")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("disableSandbox")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[t("p",[t("strong",[s._v("mockWindow（模拟 window 对象）：")]),s._v(" "),t("code",[s._v("mockWindow: false")]),s._v(" 表示不使用模拟的 "),t("code",[s._v("window")]),s._v(" 对象。在某些情况下，如果子应用依赖于全局的 "),t("code",[s._v("window")]),s._v(" 对象，可以通过配置 "),t("code",[s._v("mockWindow: false")]),s._v(" 来禁止使用模拟的 "),t("code",[s._v("window")]),s._v(" 对象。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("loose（松散模式）：")])])])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("sandbox")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("loose")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("松散模式的影响：")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("跨应用间的 window 对象共享：")]),s._v(" 在松散模式下，子应用之间共享同一个全局 "),t("code",[s._v("window")]),s._v(" 对象。这意味着一个子应用中定义的全局变量可能会被其他子应用访问到。这样做提高了全局变量的可访问性，但也带来了潜在的变量冲突风险。")]),s._v(" "),t("li",[t("strong",[s._v("样式隔离放宽：")]),s._v(" 在松散模式下，对样式的隔离会相对宽松一些。子应用的样式可能会对其他子应用产生影响，因为样式的隔离程度相对较低。")])]),s._v(" "),t("p",[s._v("注意事项：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("慎用松散模式：")]),s._v(" 虽然松散模式提高了一些全局变量的可访问性和样式的隔离宽松度，但同时也增加了变量冲突和样式污染的风险。在使用时需要慎重考虑，并确保了解潜在的影响。")]),s._v(" "),t("li",[t("strong",[s._v("默认值：")]),s._v(" 如果不显式设置 "),t("code",[s._v("sandbox")]),s._v(" 配置项，Qiankun 会默认启用松散模式，这是为了提高兼容性。在一些情况下，可以根据实际需求选择是否开启或关闭松散模式。")]),s._v(" "),t("li",[t("strong",[s._v("保持一致性：")]),s._v(" 如果多个子应用中有共享的全局状态或全局变量，确保它们的定义和使用方式保持一致，以降低潜在的冲突风险。")])]),s._v(" "),t("p",[s._v("总体来说，松散模式的沙箱配置在一些特定场景下可能是有用的，但在使用时需要谨慎，并充分了解其对全局变量和样式的影响。")])])}),[],!1,null,null,null);t.default=r.exports}}]);