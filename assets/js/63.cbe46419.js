(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{522:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("在 React 中，当父组件和子组件都使用了 "),s("code",[t._v("useEffect")]),t._v(" 时，React 遵循一定的渲染顺序和生命周期规则，导致 "),s("strong",[t._v("子组件的 "),s("code",[t._v("useEffect")]),t._v(" 会先于父组件的 "),s("code",[t._v("useEffect")]),t._v(" 执行")]),t._v("。这种行为的原因涉及 React 的渲染流程、协调机制以及副作用的处理顺序。")]),t._v(" "),s("h3",{attrs:{id:"执行顺序概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行顺序概述"}},[t._v("#")]),t._v(" 执行顺序概述")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("渲染阶段：")])]),t._v(" "),s("ul",[s("li",[t._v("React 先从父组件开始渲染，再递归渲染其子组件。因此，"),s("strong",[t._v("渲染顺序是从父组件到子组件")]),t._v("。")]),t._v(" "),s("li",[t._v("当所有组件完成渲染后，React 才开始执行 "),s("code",[t._v("useEffect")]),t._v(" 钩子。")])])]),t._v(" "),s("li",[s("p",[s("strong",[s("code",[t._v("useEffect")]),t._v(" 的执行顺序：")])]),t._v(" "),s("ul",[s("li",[t._v("虽然渲染是自上而下进行的，但 "),s("code",[t._v("useEffect")]),t._v(" 的执行是自下而上进行的。也就是说，"),s("strong",[t._v("子组件的 "),s("code",[t._v("useEffect")]),t._v(" 先于父组件的 "),s("code",[t._v("useEffect")]),t._v(" 执行")]),t._v("。")])])])]),t._v(" "),s("h3",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),s("div",{staticClass:"language-jsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-jsx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Parent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Parent useEffect"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Child")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Child")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Child useEffect"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Child Component")]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])]),s("p",[s("strong",[t._v("执行顺序：")])]),t._v(" "),s("ol",[s("li",[t._v("React 先渲染 "),s("code",[t._v("Parent")]),t._v(" 组件。")]),t._v(" "),s("li",[t._v("然后渲染 "),s("code",[t._v("Child")]),t._v(" 组件。")]),t._v(" "),s("li",[t._v("渲染完成后，先执行 "),s("code",[t._v("Child")]),t._v(" 的 "),s("code",[t._v("useEffect")]),t._v("，输出 "),s("code",[t._v("Child useEffect")]),t._v("。")]),t._v(" "),s("li",[t._v("最后执行 "),s("code",[t._v("Parent")]),t._v(" 的 "),s("code",[t._v("useEffect")]),t._v("，输出 "),s("code",[t._v("Parent useEffect")]),t._v("。")])]),t._v(" "),s("h3",{attrs:{id:"为什么子组件的-useeffect-先执行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么子组件的-useeffect-先执行"}},[t._v("#")]),t._v(" 为什么子组件的 "),s("code",[t._v("useEffect")]),t._v(" 先执行？")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("渲染流程决定：")])]),t._v(" "),s("ul",[s("li",[t._v("React 会先从父组件开始渲染，递归地渲染子组件。当所有组件的渲染完成后，才会执行 "),s("code",[t._v("useEffect")]),t._v("。")]),t._v(" "),s("li",[t._v("由于 "),s("code",[t._v("useEffect")]),t._v(" 是在渲染完成后触发的，React 会从最底层的子组件开始执行副作用，再逐层向上。")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("保证父组件的 "),s("code",[t._v("useEffect")]),t._v(" 依赖子组件的更新：")])]),t._v(" "),s("ul",[s("li",[t._v("React 设计这样的执行顺序是为了确保当父组件的 "),s("code",[t._v("useEffect")]),t._v(" 执行时，子组件已经完全渲染并完成了自己的副作用处理。")]),t._v(" "),s("li",[t._v("这有助于避免父组件依赖子组件的状态或 DOM 元素时出现不一致的情况。例如，父组件在 "),s("code",[t._v("useEffect")]),t._v(" 中操作子组件的 DOM 时，React 需要确保子组件已经完全加载。")])])])]),t._v(" "),s("h3",{attrs:{id:"react-的协调机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-的协调机制"}},[t._v("#")]),t._v(" React 的协调机制")]),t._v(" "),s("p",[t._v("React 的协调（Reconciliation）机制确保所有组件在完成渲染后，"),s("code",[t._v("useEffect")]),t._v(" 钩子按深度优先的顺序执行，即从最深的子组件开始，再回到父组件。这保证了父组件在其 "),s("code",[t._v("useEffect")]),t._v(" 中可以依赖子组件的最终状态或渲染结果。")]),t._v(" "),s("h3",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("React 中 "),s("code",[t._v("useEffect")]),t._v(" 的执行顺序是"),s("strong",[t._v("先子后父")]),t._v("，这是由于 React 的渲染流程和协调机制所决定的。它确保了父组件在执行副作用时，子组件已经完成了自己的渲染和副作用处理，避免了状态或 DOM 不一致的问题。这种设计有助于确保组件树中各层的副作用处理正确且顺序合理。")])])}),[],!1,null,null,null);s.default=e.exports}}]);