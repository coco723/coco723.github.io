(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{568:function(s,e,a){"use strict";a.r(e);var n=a(2),t=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[e("a",{attrs:{href:"https://docs.docker.com/ee/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker官网"),e("OutboundLink")],1)]),s._v(" "),e("h2",{attrs:{id:"homebrew安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#homebrew安装"}},[s._v("#")]),s._v(" Homebrew安装")]),s._v(" "),e("p",[s._v("macOS我们可以使用Homebrew来安装docker\nHomebrew 的 Cask 已经支持 Docker for Mac，因此可以很方便的使用 Homebrew Cask 来进行安装：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装命令")]),s._v("\nbrew cask "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Satisfying dependencies\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Downloading https://download.docker.com/mac/stable/28905/Docker.dmg\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################################################## 100.0%")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Verifying SHA-256 checksum "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" Cask "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'docker'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Installing Cask "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Moving App "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Docker.app'")]),s._v(" to "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/Applications/Docker.app'")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" was successfully installed"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h2",{attrs:{id:"手动安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#手动安装"}},[s._v("#")]),s._v(" 手动安装")]),s._v(" "),e("p",[s._v("下载最新的Docker for Mac或者Edge版本，即可以看到内置的kubernets集群，直接点击安装即可")]),s._v(" "),e("p",[e("img",{staticClass:"lazy",attrs:{alt:"","data-src":"https://upload-images.jianshu.io/upload_images/9403248-e287d34bf5d15034.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",loading:"lazy"}})]),s._v(" "),e("p",[s._v("安装完毕后，如果页勾选了Show system containers选项，那么使用如下的Docker命令，能看到自动安装的kubernetes相关容器：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("➜  ~ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--format")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"table{{.Names}}'),e("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[s._v("\\t")]),s._v("{{.Image }}"),e("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[s._v("\\t")]),s._v('{{.Command}}"')]),s._v("\nNAMES                                                                                                                   IMAGE                                                    COMMAND\nk8s_compose_compose-75f8bb4779-stxv9_docker_3c963862-f9f4-11e7-93cc-025000000001_0                                      docker/kube-compose-controller                           "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/compose-controller…"')]),s._v("\nk8s_POD_compose-75f8bb4779-stxv9_docker_3c963862-f9f4-11e7-93cc-025000000001_0                                          gcr.io/google_containers/pause-amd64:3.0                 "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/pause"')]),s._v("\nk8s_sidecar_kube-dns-545bc4bfd4-799pr_kube-system_139bf000-f9f4-11e7-93cc-025000000001_0                                gcr.io/google_containers/k8s-dns-sidecar-amd64           "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/sidecar --v=2 --lo…"')]),s._v("\nk8s_dnsmasq_kube-dns-545bc4bfd4-799pr_kube-system_139bf000-f9f4-11e7-93cc-025000000001_0                                gcr.io/google_containers/k8s-dns-dnsmasq-nanny-amd64     "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dnsmasq-nanny -v=2…"')]),s._v("\nk8s_kubedns_kube-dns-545bc4bfd4-799pr_kube-system_139bf000-f9f4-11e7-93cc-025000000001_0                                gcr.io/google_containers/k8s-dns-kube-dns-amd64          "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/kube-dns --domain=…"')]),s._v("\nk8s_kube-proxy_kube-proxy-rrd8t_kube-system_139b00df-f9f4-11e7-93cc-025000000001_0                                      gcr.io/google_containers/kube-proxy-amd64                "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/bin/kube…"')]),s._v("\nk8s_POD_kube-dns-545bc4bfd4-799pr_kube-system_139bf000-f9f4-11e7-93cc-025000000001_0                                    gcr.io/google_containers/pause-amd64:3.0                 "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/pause"')]),s._v("\nk8s_POD_kube-proxy-rrd8t_kube-system_139b00df-f9f4-11e7-93cc-025000000001_0                                             gcr.io/google_containers/pause-amd64:3.0                 "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/pause"')]),s._v("\nk8s_kube-scheduler_kube-scheduler-docker-for-desktop_kube-system_972d74c9fc2f4ebd8ab673058e386a65_0                     gcr.io/google_containers/kube-scheduler-amd64            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-scheduler --ad…"')]),s._v("\nk8s_kube-apiserver_kube-apiserver-docker-for-desktop_kube-system_f7a81e8fe624bd46059fc6084e86bb81_0                     gcr.io/google_containers/kube-apiserver-amd64            "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-apiserver --ad…"')]),s._v("\nk8s_etcd_etcd-docker-for-desktop_kube-system_56a21c0a5f545c0cca5388c457bb1b3b_0                                         gcr.io/google_containers/etcd-amd64                      "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"etcd --advertise-cl…"')]),s._v("\nk8s_kube-controller-manager_kube-controller-manager-docker-for-desktop_kube-system_8d1848c1e562e35a225e402988eadcd1_0   gcr.io/google_containers/kube-controller-manager-amd64   "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-controller-man…"')]),s._v("\nk8s_POD_kube-apiserver-docker-for-desktop_kube-system_f7a81e8fe624bd46059fc6084e86bb81_0                                gcr.io/google_containers/pause-amd64:3.0                 "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/pause"')]),s._v("\nk8s_POD_kube-controller-manager-docker-for-desktop_kube-system_8d1848c1e562e35a225e402988eadcd1_0                       gcr.io/google_containers/pause-amd64:3.0                 "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/pause"')]),s._v("\nk8s_POD_kube-scheduler-docker-for-desktop_kube-system_972d74c9fc2f4ebd8ab673058e386a65_0                                gcr.io/google_containers/pause-amd64:3.0                 "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/pause"')]),s._v("\nk8s_POD_etcd-docker-for-desktop_kube-system_56a21c0a5f545c0cca5388c457bb1b3b_0 \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("p",[s._v("关于各个容器的作用，可以残月"),e("a",{attrs:{href:"https://github.com/kubernetes/kubernetes/tree/master/build",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),e("OutboundLink")],1),s._v("。在安装过程中，Docker页为我们安装了kubectl控制命令：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ kubectl get namespaces\n$ kubectl get posts "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespace")]),s._v(" kube-system\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("接下来我们可以使用kubectl命令来创建简单的kubernets-dashboard服务：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("➜  ~ kubectl create "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" https://raw.githubusercontent.com/kubernetes/dashboard/master/src/deploy/recommended/kubernetes-dashboard.yaml\nsecret "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes-dashboard-certs"')]),s._v(" created\nserviceaccount "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes-dashboard"')]),s._v(" created\nrole "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes-dashboard-minimal"')]),s._v(" created\nrolebinding "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes-dashboard-minimal"')]),s._v(" created\ndeployment "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes-dashboard"')]),s._v(" created\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubernetes-dashboard"')]),s._v(" created\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("服务安装完毕后可以查看部署的容器和服务：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("➜  ~ kubectl get deployments "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespace")]),s._v(" kube-system\nNAME                   DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\nkube-dns               "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           22m\nkubernetes-dashboard   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("           26s\n➜  ~ kubectl get services "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespace")]),s._v(" kube-system\nNAME                   TYPE        CLUSTER-IP      EXTERNAL-IP   PORT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("         AGE\nkube-dns               ClusterIP   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".0.10      "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v("/UDP,53/TCP   22m\nkubernetes-dashboard   ClusterIP   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.111")]),s._v(".242.95   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/TCP         30s\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("在Dashboard启动完毕后，可以使用kubectl提供的Proxy服务来访问该面板：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ kubectl proxy\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开如下地址：")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("如果访问出错，可以尝试kubernetes-dashboard服务，或者查阅"),e("a",{attrs:{href:"https://github.com/kubernetes/dashboard/wiki/Accessing-Dashboard---1.7.X-and-above",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ kubectl "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" kube-system edit "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" kubernetes-dashboard\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Please edit the object below. Lines beginning with a '#' will be ignored,")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# and an empty file will abort the edit. If an error occurs while saving this file will be")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# reopened with the relevant failures.")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\napiVersion: v1\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n  name: kubernetes-dashboard\n  namespace: kube-system\n  resourceVersion: "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"343478"')]),s._v("\n  selfLink: /api/v1/namespaces/kube-system/services/kubernetes-dashboard-head\n  uid: 8e48f478-993d-11e7-87e0-901b0e532516\nspec:\n  clusterIP: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".124.90\n  externalTrafficPolicy: Cluster\n  ports:\n  - port: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("\n    protocol: TCP\n    targetPort: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v("\n  selector:\n    k8s-app: kubernetes-dashboard\n  sessionAffinity: None\n  type: ClusterIP -"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" NodePort\nstatus:\n  loadBalancer: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br")])]),e("p",[s._v("访问上述地址，我们可以看到登陆界面：\n"),e("img",{staticClass:"lazy",attrs:{alt:"kubernetes登陆界面","data-src":"https://upload-images.jianshu.io/upload_images/9403248-c6881f0c4bc40cf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",loading:"lazy"}})]),s._v(" "),e("p",[s._v("此时可暂时直接跳过，进入到控制面板中\n"),e("img",{staticClass:"lazy",attrs:{alt:"kubernetes","data-src":"https://upload-images.jianshu.io/upload_images/9403248-dd1431fe9341d11b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",loading:"lazy"}})]),s._v(" "),e("p",[s._v("Docker同样为我们提供了简单的应用示范，可以直接使用如下的Docker Compose配置文件：")]),s._v(" "),e("div",{staticClass:"language-json line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[s._v("version"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" '"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.3")]),s._v("'\n\nservices"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  web"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    build"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" web\n    image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" dockerdemos/lab-web\n    volumes"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n     - "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./web/static:/static"')]),s._v("\n    ports"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n     - "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80:80"')]),s._v("\n\n  words"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    build"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" words\n    image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" dockerdemos/lab-words\n    deploy"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n      replicas"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n      endpoint_mode"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" dnsrr\n      resources"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        limits"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n          memory"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 16M\n        reservations"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n          memory"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 16M\n\n  db"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    build"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" db\n    image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" dockerdemos/lab-db\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])]),e("p",[s._v("然后使用stack命令创建应用栈：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stack deploy --compose-file stack.yml demo\n\nStack demo was created\nWaiting "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the stack to be stable and running"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n - Service web has one container running\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("应用栈创建完毕后，可以使kubectl查看创建的Pods:")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ kubectl get pods\n\nNAME                     READY     STATUS    RESTARTS   AGE\ndb-7f99cc64b7-cbd9t      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2m\nweb-758c6998f8-tmxfm     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2m\nwords-54bf6c5d57-8bxc8   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2m\nwords-54bf6c5d57-dzxm8   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2m\nwords-54bf6c5d57-k2448   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2m\nwords-54bf6c5d57-mhh4p   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2m\nwords-54bf6c5d57-w2q82   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1       Running   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          2m\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("p",[s._v("也可以来查看部署的集群与服务：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ kubectl get deployments\nNAME      DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\ndb        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           3m\nweb       "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           3m\nwords     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("           3m\n\n$ kubectl get services\nNAME         TYPE           CLUSTER-IP     EXTERNAL-IP   PORT"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        AGE\ndb           ClusterIP      None           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("55555")]),s._v("/TCP      3m\nkubernetes   ClusterIP      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".0.1      "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/TCP        52m\nweb          LoadBalancer   "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.97")]),s._v(".154.28   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pending"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":30577/TCP   3m\nwords        ClusterIP      None           "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("55555")]),s._v("/TCP      3m\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("p",[s._v("可以看到这里的web有所谓的LoadBalancer类型，机可以对外提供服务。最后我们可以用stack与kubectl名利ing来删除应用：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stack remove demo\n$ kubectl delete deployment kubernetes-dashboard "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespace")]),s._v(" kube-system\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"镜像加速"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#镜像加速"}},[s._v("#")]),s._v(" 镜像加速")]),s._v(" "),e("p",[s._v("鉴于国内网络问题，后续拉取Docker镜像十分缓慢，我们需要配置加速期来解决，")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://registry.docker-cn.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"http://hub-mirror.c.163.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("网易"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"http://dev.aliyun.com/search.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云"),e("OutboundLink")],1),s._v(": 阿里云的镜像官方地址是：http://dev.aliyun.com/search.html， 开发这需要开通阿里开发者账户，登陆后https://cr.console.aliyun.com/undefined/instances/mirrors 中查看你的专属加速器地址")])])])}),[],!1,null,null,null);e.default=t.exports}}]);